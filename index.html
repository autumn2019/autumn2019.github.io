<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.2">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.2" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="忽然一夜清香发，散作乾坤万里春">
<meta property="og:url" content="http://blog.mid-autumn.com/index.html">
<meta property="og:site_name" content="忽然一夜清香发，散作乾坤万里春">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="忽然一夜清香发，散作乾坤万里春">





  
  
  <link rel="canonical" href="http://blog.mid-autumn.com/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>忽然一夜清香发，散作乾坤万里春</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">忽然一夜清香发，散作乾坤万里春</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.mid-autumn.com/2019/06/13/CoreOS与Kubernetes/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忽然一夜清香发，散作乾坤万里春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/13/CoreOS与Kubernetes/" class="post-title-link" itemprop="url">CoreOS与Kubernetes</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-13 16:59:16" itemprop="dateCreated datePublished" datetime="2019-06-13T16:59:16+08:00">2019-06-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-06-15 17:12:49" itemprop="dateModified" datetime="2019-06-15T17:12:49+08:00">2019-06-15</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在此之前，运行Docker的环境，主要是以Ubuntu主机为主，编排工具也主要是docker-compose。<br>到现在，docker-compose以逐渐不能满足我们日常对运维部署的需要，而kubernetes也日益的作为我们日常应用部署的主要编排工具。  </p>
<p>随之，CoreOS也进入了替代Ubuntu作为我们docker运行的宿主操作系统的日程。  </p>
<p>本文主要记录CoreOS及Kubernetes的安装工作。  </p>
<h1 id="CoreOS的安装"><a href="#CoreOS的安装" class="headerlink" title="CoreOS的安装"></a>CoreOS的安装</h1><h2 id="镜像制作"><a href="#镜像制作" class="headerlink" title="镜像制作"></a>镜像制作</h2><h2 id="ignition-yaml及ignition-json"><a href="#ignition-yaml及ignition-json" class="headerlink" title="ignition.yaml及ignition.json"></a>ignition.yaml及ignition.json</h2><h3 id="ignition-yaml"><a href="#ignition-yaml" class="headerlink" title="ignition.yaml"></a>ignition.yaml</h3><figure class="highlight yaml"><figcaption><span>ignition.yaml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">etcd:</span></span><br><span class="line"><span class="attr">  version:</span> <span class="number">3.1</span><span class="number">.6</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">coreos91</span></span><br><span class="line"><span class="attr">  advertise_client_urls:</span> <span class="attr">http://192.168.10.91:2379</span></span><br><span class="line"><span class="attr">  initial_advertise_peer_urls:</span> <span class="attr">http://192.168.10.91:2380</span></span><br><span class="line"><span class="attr">  listen_client_urls:</span> <span class="attr">http://0.0.0.0:2379</span></span><br><span class="line"><span class="attr">  listen_peer_urls:</span> <span class="attr">http://192.168.10.91:2380</span></span><br><span class="line"><span class="attr">  initial_cluster:</span> <span class="string">coreos91=http://192.168.10.91:2380</span></span><br><span class="line"></span><br><span class="line"><span class="attr">passwd:</span></span><br><span class="line"><span class="attr">  users:</span></span><br><span class="line"><span class="attr">    - name:</span> <span class="string">core</span></span><br><span class="line"><span class="attr">      password_hash:</span> <span class="string">"$6$rounds=4096$xZ9xIGea/SY$jLa.mSbH0UYZB9AjjOrvG.njyUiJBWs1lTGDCe.9ORRhWxhDdAG/b64D1ae/E4IJECnUOpH1r0pOvJPyvPDXE1"</span></span><br><span class="line"><span class="attr">      ssh_authorized_keys:</span> </span><br><span class="line"><span class="bullet">        -</span> <span class="string">ssh-rsa</span>  <span class="string">AAAAB3NzaC1yc2EAAAADAQABAAABAQDEObKTPr7gijPRdXDMfAQrmnhO6ZQz8pp+gXIx5h66bGhNrqWsq+IaMeujzkNskvP3NOmszU6BlsA3OEx6UWmmwawff/G04YUNXxDtI9Bx5GO1JW+dxr/unP33mhwMaQplKlvyuDAJwVMHHKIsn5NJv3qpfJhdWcHKK8/z1lXlwdie6sf/qKuNdo/WL3o4p5/K7IS+bkP7q6VeqHWl+jBEh1GzMtvcGLLhNpDggZH5SraAhtqK6bP51FUs/DrvdnXW6R8iQs2k2KMm6aCDq7NICO/2/YgOJN8sT9xLEynD39fqek58nqySks916//GUKPjA9bgJAPcbAPZ80B4+GQr</span></span><br><span class="line"><span class="attr">      groups:</span> </span><br><span class="line"><span class="bullet">        -</span> <span class="string">wheel</span> </span><br><span class="line"><span class="bullet">        -</span> <span class="string">sudo</span> </span><br><span class="line"><span class="bullet">        -</span> <span class="string">docker</span></span><br><span class="line"></span><br><span class="line"><span class="attr">systemd:</span></span><br><span class="line"><span class="attr">  units:</span></span><br><span class="line"><span class="attr">    - name:</span> <span class="string">flanneld.service</span></span><br><span class="line"><span class="attr">      enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">      dropins:</span></span><br><span class="line"><span class="attr">      - name:</span> <span class="number">50</span><span class="bullet">-network-config.conf</span></span><br><span class="line"><span class="attr">        contents:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          [Service]</span></span><br><span class="line"><span class="string">          ExecStartPre=/usr/bin/etcdctl set /coreos.com/network/config '&#123;"Network":"10.1.0.0/16", "Backend": &#123;"Type": "vxlan"&#125;&#125;'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span><span class="attr">networkd:</span></span><br><span class="line"><span class="attr">  units:</span></span><br><span class="line"><span class="attr">    - name:</span> <span class="string">static.network</span></span><br><span class="line"><span class="attr">      contents:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        [Match]</span></span><br><span class="line"><span class="string">        Name=enp0s31f6</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        [Network]</span></span><br><span class="line"><span class="string">        Address=192.168.10.91/24</span></span><br><span class="line"><span class="string">        Gateway=192.168.10.1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span><span class="attr">storage:</span></span><br><span class="line"><span class="attr">  files:</span></span><br><span class="line"><span class="attr">    - filesystem:</span> <span class="string">"root"</span></span><br><span class="line"><span class="attr">      path:</span>       <span class="string">"/etc/hostname"</span></span><br><span class="line"><span class="attr">      mode:</span>       <span class="number">0644</span></span><br><span class="line"><span class="attr">      contents:</span></span><br><span class="line"><span class="attr">        inline:</span> <span class="string">coreos91</span></span><br><span class="line"><span class="attr">    - filesystem:</span> <span class="string">"root"</span></span><br><span class="line"><span class="attr">      path:</span>       <span class="string">"/etc/resolv.conf"</span></span><br><span class="line"><span class="attr">      mode:</span>       <span class="number">0644</span></span><br><span class="line"><span class="attr">      contents:</span></span><br><span class="line"><span class="attr">        inline:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          nameserver 192.168.10.1</span></span><br></pre></td></tr></table></figure>
<h3 id="ignition-json"><a href="#ignition-json" class="headerlink" title="ignition.json"></a>ignition.json</h3><figure class="highlight yaml"><figcaption><span>ignition.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#123;</span></span><br><span class="line">	<span class="string">"ignition"</span><span class="string">:</span> <span class="string">&#123;</span></span><br><span class="line">		<span class="string">"config"</span><span class="string">:</span> <span class="string">&#123;&#125;,</span></span><br><span class="line">		<span class="string">"security"</span><span class="string">:</span> <span class="string">&#123;</span></span><br><span class="line">			<span class="string">"tls"</span><span class="string">:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">		<span class="string">&#125;,</span></span><br><span class="line">		<span class="string">"timeouts"</span><span class="string">:</span> <span class="string">&#123;&#125;,</span></span><br><span class="line">		<span class="string">"version"</span><span class="string">:</span> <span class="string">"2.2.0"</span></span><br><span class="line">	<span class="string">&#125;,</span></span><br><span class="line">	<span class="string">"networkd"</span><span class="string">:</span> <span class="string">&#123;</span></span><br><span class="line">		<span class="string">"units"</span><span class="string">:</span> <span class="string">[&#123;</span></span><br><span class="line">			<span class="string">"contents"</span><span class="string">:</span> <span class="string">"[Match]\nName=enp0s31f6\n\n[Network]\nAddress=192.168.10.91/24\nGateway=192.168.10.1\n"</span><span class="string">,</span></span><br><span class="line">			<span class="string">"name"</span><span class="string">:</span> <span class="string">"static.network"</span></span><br><span class="line">		<span class="string">&#125;]</span></span><br><span class="line">	<span class="string">&#125;,</span></span><br><span class="line">	<span class="string">"passwd"</span><span class="string">:</span> <span class="string">&#123;</span></span><br><span class="line">		<span class="string">"users"</span><span class="string">:</span> <span class="string">[&#123;</span></span><br><span class="line">			<span class="string">"groups"</span><span class="string">:</span> <span class="string">["wheel",</span> <span class="string">"sudo"</span><span class="string">,</span> <span class="string">"docker"</span><span class="string">],</span></span><br><span class="line">			<span class="string">"name"</span><span class="string">:</span> <span class="string">"core"</span><span class="string">,</span></span><br><span class="line">			<span class="string">"passwordHash"</span><span class="string">:</span> <span class="string">"$6$rounds=4096$xZ9xIGea/SY$jLa.mSbH0UYZB9AjjOrvG.njyUiJBWs1lTGDCe.9ORRhWxhDdAG/b64D1ae/E4IJECnUOpH1r0pOvJPyvPDXE1"</span><span class="string">,</span></span><br><span class="line">			<span class="string">"sshAuthorizedKeys"</span><span class="string">:</span> <span class="string">["ssh-rsa</span>  <span class="string">AAAAB3NzaC1yc2EAAAADAQABAAABAQDEObKTPr7gijPRdXDMfAQrmnhO6ZQz8pp+gXIx5h66bGhNrqWsq+IaMeujzkNskvP3NOmszU6BlsA3OEx6UWmmwawff/G04YUNXxDtI9Bx5GO1JW+dxr/unP33mhwMaQplKlvyuDAJwVMHHKIsn5NJv3qpfJhdWcHKK8/z1lXlwdie6sf/qKuNdo/WL3o4p5/K7IS+bkP7q6VeqHWl+jBEh1GzMtvcGLLhNpDggZH5SraAhtqK6bP51FUs/DrvdnXW6R8iQs2k2KMm6aCDq7NICO/2/YgOJN8sT9xLEynD39fqek58nqySks916//GUKPjA9bgJAPcbAPZ80B4+GQr"]</span></span><br><span class="line">		<span class="string">&#125;]</span></span><br><span class="line">	<span class="string">&#125;,</span></span><br><span class="line">	<span class="string">"storage"</span><span class="string">:</span> <span class="string">&#123;</span></span><br><span class="line">		<span class="string">"files"</span><span class="string">:</span> <span class="string">[&#123;</span></span><br><span class="line">			<span class="string">"filesystem"</span><span class="string">:</span> <span class="string">"root"</span><span class="string">,</span></span><br><span class="line">			<span class="string">"path"</span><span class="string">:</span> <span class="string">"/etc/hostname"</span><span class="string">,</span></span><br><span class="line">			<span class="string">"contents"</span><span class="string">:</span> <span class="string">&#123;</span></span><br><span class="line">				<span class="string">"source"</span><span class="string">:</span> <span class="string">"data:,coreos91"</span><span class="string">,</span></span><br><span class="line">				<span class="string">"verification"</span><span class="string">:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">			<span class="string">&#125;,</span></span><br><span class="line">			<span class="string">"mode"</span><span class="string">:</span> <span class="number">420</span></span><br><span class="line">		<span class="string">&#125;,</span> <span class="string">&#123;</span></span><br><span class="line">			<span class="string">"filesystem"</span><span class="string">:</span> <span class="string">"root"</span><span class="string">,</span></span><br><span class="line">			<span class="string">"path"</span><span class="string">:</span> <span class="string">"/etc/resolv.conf"</span><span class="string">,</span></span><br><span class="line">			<span class="string">"contents"</span><span class="string">:</span> <span class="string">&#123;</span></span><br><span class="line">				<span class="string">"source"</span><span class="string">:</span> <span class="string">"data:,nameserver%20192.168.10.1%0A"</span><span class="string">,</span></span><br><span class="line">				<span class="string">"verification"</span><span class="string">:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">			<span class="string">&#125;,</span></span><br><span class="line">			<span class="string">"mode"</span><span class="string">:</span> <span class="number">420</span></span><br><span class="line">		<span class="string">&#125;]</span></span><br><span class="line">	<span class="string">&#125;,</span></span><br><span class="line">	<span class="string">"systemd"</span><span class="string">:</span> <span class="string">&#123;</span></span><br><span class="line">		<span class="string">"units"</span><span class="string">:</span> <span class="string">[&#123;</span></span><br><span class="line">			<span class="string">"dropins"</span><span class="string">:</span> <span class="string">[&#123;</span></span><br><span class="line">				<span class="string">"contents"</span><span class="string">:</span> <span class="string">"[Service]\nEnvironment=\"ETCD_IMAGE_TAG=v3.1.6\"\nExecStart=\nExecStart=/usr/lib/coreos/etcd-wrapper $ETCD_OPTS \\\n  --name=\"coreos91\" \\\n  --listen-peer-urls=\"http://192.168.10.91:2380\" \\\n  --listen-client-urls=\"http://0.0.0.0:2379\" \\\n  --initial-advertise-peer-urls=\"http://192.168.10.91:2380\" \\\n  --initial-cluster=\"coreos91=http://192.168.10.91:2380\" \\\n  --advertise-client-urls=\"http://192.168.10.91:2379\""</span><span class="string">,</span></span><br><span class="line">				<span class="string">"name"</span><span class="string">:</span> <span class="string">"20-clct-etcd-member.conf"</span></span><br><span class="line">			<span class="string">&#125;],</span></span><br><span class="line">			<span class="string">"enable"</span><span class="string">:</span> <span class="literal">true</span><span class="string">,</span></span><br><span class="line">			<span class="string">"name"</span><span class="string">:</span> <span class="string">"etcd-member.service"</span></span><br><span class="line">		<span class="string">&#125;,</span> <span class="string">&#123;</span></span><br><span class="line">			<span class="string">"dropins"</span><span class="string">:</span> <span class="string">[&#123;</span></span><br><span class="line">				<span class="string">"contents"</span><span class="string">:</span> <span class="string">"[Service]\nExecStartPre=/usr/bin/etcdctl set /coreos.com/network/config '&#123;\"Network\":\"10.1.0.0/16\", \"Backend\": &#123;\"Type\": \"vxlan\"&#125;&#125;'\n"</span><span class="string">,</span></span><br><span class="line">				<span class="string">"name"</span><span class="string">:</span> <span class="string">"50-network-config.conf"</span></span><br><span class="line">			<span class="string">&#125;],</span></span><br><span class="line">			<span class="string">"enable"</span><span class="string">:</span> <span class="literal">true</span><span class="string">,</span></span><br><span class="line">			<span class="string">"name"</span><span class="string">:</span> <span class="string">"flanneld.service"</span></span><br><span class="line">		<span class="string">&#125;]</span></span><br><span class="line">	<span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="Kubernetes的安装"><a href="#Kubernetes的安装" class="headerlink" title="Kubernetes的安装"></a>Kubernetes的安装</h1><h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><h2 id="附录一-Cluster-TLS-using-OpenSSL"><a href="#附录一-Cluster-TLS-using-OpenSSL" class="headerlink" title="附录一 Cluster TLS using OpenSSL"></a>附录一 Cluster TLS using OpenSSL</h2><p>参考地址：<a href="https://coreos.com/kubernetes/docs/1.0.6/openssl.html" target="_blank" rel="noopener">Cluster TLS using OpenSSL</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">export K8S_SERVICE_IP=10.3.0.1</span><br><span class="line">export MASTER_HOST=192.168.10.91</span><br><span class="line"></span><br><span class="line">openssl genrsa -out ca-key.pem 2048</span><br><span class="line"></span><br><span class="line">openssl req -x509 -new -nodes -key ca-key.pem -days 10000 -out ca.pem -subj "/CN=kube-ca"</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="一些CoreOS命令"><a href="#一些CoreOS命令" class="headerlink" title="一些CoreOS命令"></a>一些CoreOS命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sudo hostnamectl set-hostname coreos1 #修改主机名</span><br><span class="line">setenforce 1/0 #开启关闭SELinux</span><br><span class="line">getenforce #查看SELinux状态</span><br><span class="line">timedatectl #查看系统时间</span><br><span class="line">timedatectl list-timezones #查看支持的时区列表</span><br><span class="line">timedatectl set-timezone Asia/Shanghai #设置时区为上海</span><br><span class="line"></span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.mid-autumn.com/2019/05/21/Go-Modules-使用示例/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忽然一夜清香发，散作乾坤万里春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/21/Go-Modules-使用示例/" class="post-title-link" itemprop="url">Go Modules 使用示例</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-21 15:48:00 / Modified: 16:41:40" itemprop="dateCreated datePublished" datetime="2019-05-21T15:48:00+08:00">2019-05-21</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote><p>参考页面<a href="https://www.njphper.com/posts/8b58ea6d.html" target="_blank" rel="noopener">Go Modules 详解使用</a></p>
</blockquote>
<h1 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h1><p>自从<code>Go</code>官方从去年推出 1.11 之后，增加新的依赖管理模块并且更加易于管理项目中所需要的模块。模块是存储在文件树中的 Go 包的集合，其根目录中包含 go.mod 文件。 go.mod 文件定义了模块的模块路径，它也是用于根目录的导入路径，以及它的依赖性要求。每个依赖性要求都被写为模块路径和特定语义版本。</p>
<p>从 Go 1.11 开始，Go 允许在 $GOPATH/src 外的任何目录下使用 go.mod 创建项目。在 $GOPATH/src 中，为了兼容性，Go 命令仍然在旧的 GOPATH 模式下运行。从 Go 1.13 开始，模块模式将成为默认模式。</p>
<p>本文将介绍使用模块开发 Go 代码时出现的一系列常见操作：</p>
<ul>
<li>创建一个新模块   </li>
<li>添加依赖项</li>
<li>升级依赖项</li>
<li>删除未使用的依赖项</li>
<li>使用<code>vendor</code>目录</li>
</ul>
<p>下面使用的案例都是以<code>GIN</code>模块为例。<br>在这之前呢，需要先设置一些环境变量：</p>
<figure class="highlight shell"><figcaption><span>envvars</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export GO111MODULE=on</span><br><span class="line">export GOPROXY=https://goproxy.io // 设置代理</span><br></pre></td></tr></table></figure>
<h1 id="创建一个新模块"><a href="#创建一个新模块" class="headerlink" title="创建一个新模块"></a>创建一个新模块</h1><p>你可以在 $GOPATH/src 之外的任何地方创建一个新的目录。比如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir backend &amp;&amp; cd backend</span><br></pre></td></tr></table></figure>
<p>然后初始化<code>go mod init backend</code>，成功之后你会发现目录下会生成一个<code>go.mod</code>文件.</p>
<figure class="highlight shell"><figcaption><span>go.mod</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module backend</span><br><span class="line"></span><br><span class="line">go 1.12</span><br></pre></td></tr></table></figure>
<h1 id="添加依赖项"><a href="#添加依赖项" class="headerlink" title="添加依赖项"></a>添加依赖项</h1><p>创建一个文件 main.go 然后加入以下代码，这里直接 import 了 gin 的依赖包。</p>
<figure class="highlight golang"><figcaption><span>main.go</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">"/ping"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">"message"</span>: <span class="string">"pong"</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.Run() <span class="comment">// listen and serve on 0.0.0.0:8080</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>go build 之后，会在 go.mod 引入所需要的依赖包。之后再来看看 go.mod 文件的情况。</p>
<figure class="highlight shell"><figcaption><span>go.mod</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">module backend</span><br><span class="line"></span><br><span class="line">go 1.12</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">	github.com/gin-contrib/sse v0.0.0-20190301062529-5545eab6dad3 // indirect</span><br><span class="line">	github.com/gin-gonic/gin v1.3.0</span><br><span class="line">	github.com/golang/protobuf v1.3.1 // indirect</span><br><span class="line">	github.com/mattn/go-isatty v0.0.7 // indirect</span><br><span class="line">	github.com/ugorji/go v1.1.4 // indirect</span><br><span class="line">	gopkg.in/go-playground/validator.v8 v8.18.2 // indirect</span><br><span class="line">	gopkg.in/yaml.v2 v2.2.2 // indirect</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>require 就是 gin 框架所需要的所有依赖包 并且在每个依赖包的后面已经表明了版本号</p>
<h1 id="升级依赖项"><a href="#升级依赖项" class="headerlink" title="升级依赖项"></a>升级依赖项</h1><p>首先我们需要查看以下我们使用到的依赖列表</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> go list -m all</span><br><span class="line">// 你会看到所有项目使用的依赖包</span><br><span class="line">backend</span><br><span class="line">github.com/gin-contrib/sse v0.0.0-20190301062529-5545eab6dad3</span><br><span class="line">github.com/gin-gonic/gin v1.3.0</span><br><span class="line">github.com/golang/protobuf v1.3.1</span><br><span class="line">github.com/mattn/go-isatty v0.0.7</span><br><span class="line">github.com/ugorji/go v1.1.4</span><br><span class="line">golang.org/x/sys v0.0.0-20190222072716-a9d3bda3a223</span><br><span class="line">gopkg.in/check.v1 v0.0.0-20161208181325-20d25e280405</span><br><span class="line">gopkg.in/go-playground/validator.v8 v8.18.2</span><br><span class="line">gopkg.in/yaml.v2 v2.2.2</span><br></pre></td></tr></table></figure>
<p>因为这里使用的是最新的版本，无法升级，所以这里给出一个回退的例子。将 GIN 框架的版本回退到上个版本。这里需要使用一个命令查看依赖的版本历史。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> go list -m -versions github.com/gin-gonic/gin</span><br><span class="line">// 将会列出 Gin 版本历史</span><br><span class="line">github.com/gin-gonic/gin v1.1.1 v1.1.2 v1.1.3 v1.1.4 v1.3.0</span><br></pre></td></tr></table></figure>
<p>将版本更新到上个版本，这里只是个演示。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&gt;</span> go get github.com/gin-gonic/gin@v1.1.4 // 只需要在依赖后面加上 @version 就可以了</span><br><span class="line"><span class="meta">&gt;</span> go list -m all</span><br><span class="line">// 看到了版本变化</span><br><span class="line">github.com/gin-gonic/gin v1.1.4</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>或者可以使用 go mod来进行版本的切换, 这样就需要两个步骤了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> go mod edit -require="github.com/gin-gonic/gin@v1.1.4" // 修改 go.mod 文件</span><br><span class="line"><span class="meta">&gt;</span> go tidy //下载更新依赖</span><br></pre></td></tr></table></figure>
<p>go.tidy 会自动清理掉不需要的依赖项，同时可以将依赖项更新到当前版本</p>
<p>使用起来这是一个很简单过程，只需要几个命令，你便可以知道依赖的版本信息，以及自由选择安装的版本，一切都变得这么简单。</p>
<h1 id="删除未使用的依赖项"><a href="#删除未使用的依赖项" class="headerlink" title="删除未使用的依赖项"></a>删除未使用的依赖项</h1><p>如果你在项目过程需要移除一些不需要的依赖，可以使用下面的命令来执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span>go mod tidy</span><br></pre></td></tr></table></figure>
<p>更多关于 go mod 的使用命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span>$ go mod</span><br><span class="line">The commands are:</span><br><span class="line"></span><br><span class="line">        download    download modules to local cache</span><br><span class="line">        edit        edit go.mod from tools or scripts</span><br><span class="line">        graph       print module requirement graph</span><br><span class="line">        init        initialize new module in current directory</span><br><span class="line">        tidy        add missing and remove unused modules</span><br><span class="line">        vendor      make vendored copy of dependencies</span><br><span class="line">        verify      verify dependencies have expected content</span><br><span class="line">        why         explain why packages or modules are needed</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="使用-vendor-目录"><a href="#使用-vendor-目录" class="headerlink" title="使用 vendor 目录"></a>使用 vendor 目录</h1><p>如果你不喜欢<code>go mod</code>的缓存方式，你可以使用<code>go mod vendor</code>回到 godep 或 govendor 使用的 vendor 目录进行包管理的方式。<br>当然这个命令并不能让你从godep之类的工具迁移到<code>go modules</code>，它只是单纯地把<code>go.sum</code>中的所有依赖下载到 vendor 目录里，如果你用它迁移 godep 你会发现 vendor 目录里的包会和 godep 指定的产生相当大的差异，所以请务必不要这样做。<br>使用<code>go build -mod=vendor</code>来构建项目，因为在<code>go modules</code>模式下<code>go build</code>是屏蔽 vendor 机制的，所以需要特定参数重新开启 vendor 机制:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">go build -mod=vendor</span><br><span class="line">./hello</span><br><span class="line">hello world!</span><br></pre></td></tr></table></figure>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>Go Module 是 Go 依赖管理的未来。 目前只有 1.11 和 1.12 版本支持该功能，介绍了 Go 依赖管理的功能。更多的功能会在以后补充。也欢迎补充完善。最后如果你是使用<code>Goland</code>, 请移步这里<a href="https://blog.jetbrains.com/go/2019/01/22/working-with-go-modules/" target="_blank" rel="noopener">Working with Go Modules</a> 阅读关于使用 Modules 开发</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.mid-autumn.com/2019/01/14/外部网络直接访问Docker容器方案/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忽然一夜清香发，散作乾坤万里春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/14/外部网络直接访问Docker容器方案/" class="post-title-link" itemprop="url">外部网络直接访问Docker容器方案</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-01-14 13:01:43" itemprop="dateCreated datePublished" datetime="2019-01-14T13:01:43+08:00">2019-01-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-01-15 11:14:38" itemprop="dateModified" datetime="2019-01-15T11:14:38+08:00">2019-01-15</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>默认情况下，一台机器上的docker容器之间是可以通过分配的IP进行通信的。<br>如果容器外部要访问容器服务的话，则需要容器将其服务端口开放给宿主机，或是通过如<code>traefik</code>的API网关，将服务暴露到容器外部。  </p>
<p>在实际项目中，例如，在使用spring boot cloud时，会用到的erueka；在使用apollo时，也要用到erueka。<br>然后，各个服务在到erueka注册时，都会使用自己的ip或是容器名，而这个ip或容器名是容器内部的，在外部网络是无法访问的。这下就尴尬了。  </p>
<p>erueka是一个典型，我们这次主要遇到的问题也是erueka的使用方式引起的。<br>为了能在开发环境中使用docker部署的erueka，就花时间查了下资料，并给出了在外部网络中直接访问Docker容器的方案。  </p>
<h1 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h1><h2 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h2><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">项</th>
<th style="text-align:left">值</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">操作系统</td>
<td style="text-align:left">Ubuntu 18.04.1 LTS</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">Docker版本</td>
<td style="text-align:left">18.06.1-ce</td>
<td style="text-align:left">-</td>
</tr>
</tbody>
</table>
</div>
<h2 id="网络信息"><a href="#网络信息" class="headerlink" title="网络信息"></a>网络信息</h2><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">项</th>
<th style="text-align:left">值</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">局域网</td>
<td style="text-align:left">192.168.201.0/24</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">网关</td>
<td style="text-align:left">192.168.201.1</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">网卡名称</td>
<td style="text-align:left">enp0s5</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">网桥名称</td>
<td style="text-align:left">br0</td>
<td style="text-align:left">-</td>
</tr>
</tbody>
</table>
</div>
<h2 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h2><h3 id="修改网卡设置"><a href="#修改网卡设置" class="headerlink" title="修改网卡设置"></a>修改网卡设置</h3><p><code>Ubuntu 18.04.1 LTS</code>的网卡设置使用<code>netplan</code>来进行管理的。  </p>
<p>我们需要：  </p>
<ul>
<li>设置原有的网卡<code>enp0s5</code>为非dhcp设置</li>
<li>增加网桥<code>br0</code>，并将其绑定在<code>enp0s5</code>上。</li>
</ul>
<p>修改配置文件<code>/etc/netplan/50-cloud-init.yaml</code>：</p>
<figure class="highlight yaml"><figcaption><span>/etc/netplan/50-cloud-init.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line"><span class="attr">  ethernets:</span></span><br><span class="line"><span class="attr">    enp0s5:</span></span><br><span class="line"><span class="attr">      addresses:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">      dhcp4:</span> <span class="literal">no</span></span><br><span class="line"><span class="attr">      dhcp6:</span> <span class="literal">no</span></span><br><span class="line"><span class="attr">  version:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">  bridges:</span></span><br><span class="line"><span class="attr">    br0:</span></span><br><span class="line"><span class="attr">      interfaces:</span> <span class="string">[enp0s5]</span></span><br><span class="line"><span class="attr">      dhcp4:</span> <span class="literal">yes</span></span><br><span class="line"><span class="attr">      parameters:</span></span><br><span class="line"><span class="attr">        forward-delay:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">        stp:</span> <span class="literal">true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>重启网卡：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netplan apply</span><br></pre></td></tr></table></figure>
<h3 id="修改docker启动参数"><a href="#修改docker启动参数" class="headerlink" title="修改docker启动参数"></a>修改<code>docker</code>启动参数</h3><p><code>docker</code>默认是使用网桥<code>docker0</code>，我们需要修改<code>docker</code>的启动参数，使其使用我们新加的<code>br0</code>作为网桥。  </p>
<p><code>docker</code>的启动配置文件为：<code>/etc/default/docker</code>。<br>我们增加启动参数：<code>DOCKER_OPTS=&quot;-b=br0&quot;</code></p>
<p>修改后的配置文件如下：  </p>
<figure class="highlight bash"><figcaption><span>/etc/default/docker</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">……</span><br><span class="line"></span><br><span class="line">DOCKER_OPTS=<span class="string">"-b=br0"</span></span><br><span class="line"></span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<p>修改后，重新启动<code>docker</code>引擎：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart  docker</span><br></pre></td></tr></table></figure>
<p>下面这个命令也可以：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/docker restart</span><br></pre></td></tr></table></figure>
<p>至止，docker的网络设置基本完成。  </p>
<p>接下来，我们启动一个具体的实例，来测试一下网络的访问情况。  </p>
<h2 id="启动测试容器"><a href="#启动测试容器" class="headerlink" title="启动测试容器"></a>启动测试容器</h2><p>我们使用docker-compose来启动一个nginx服务。  </p>
<p>docker-compose.yml文件如下：  </p>
<figure class="highlight yaml"><figcaption><span>nginx-demo.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">version:</span> <span class="string">'3'</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  nginx:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">    restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">    privileged:</span> <span class="literal">true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>保存<code>docker-compose.yml</code>后，执行以下命令，以启动容器：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>
<p>查看容器状态信息：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server5:~/<span class="built_in">test</span>$ docker ps </span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES</span><br><span class="line">06087a66c139        nginx               <span class="string">"nginx -g 'daemon of…"</span>   2 minutes ago       Up 2 minutes        80/tcp              test_nginx_1</span><br></pre></td></tr></table></figure>
<p>查看容器<code>06087a66c13</code>的信息:  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">server5:~/test$ docker inspect 06087a66c139</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"Id"</span>: <span class="string">"06087a66c139e0ee7184eea09b09ef74069ca18f7dd54326c62beb8bd8ad5092"</span>,</span><br><span class="line">        <span class="attr">"Created"</span>: <span class="string">"2019-01-14T14:15:50.737123692Z"</span>,</span><br><span class="line">        <span class="attr">"Path"</span>: <span class="string">"nginx"</span>,</span><br><span class="line"></span><br><span class="line">……</span><br><span class="line"></span><br><span class="line">            "MacAddress": "",</span><br><span class="line">            "Networks": &#123;</span><br><span class="line">                "test_default": &#123;</span><br><span class="line">                    "IPAMConfig": null,</span><br><span class="line">                    "Links": null,</span><br><span class="line">                    "Aliases": [</span><br><span class="line">                        "nginx",</span><br><span class="line">                        <span class="string">"06087a66c139"</span></span><br><span class="line">                    ],</span><br><span class="line">                    "NetworkID": "9c4ca378f98db8ef41a3581d9040f61355219ee89b29ca80d63a22ed7a394138",</span><br><span class="line">                    "EndpointID": "88f71955499b7249a73f87b864f044ca6bfbf6d80e17fc8ad8f02b2cd63d7d86",</span><br><span class="line">                    "Gateway": "172.22.0.1",</span><br><span class="line">                    "IPAddress": "172.22.0.2",</span><br><span class="line">                    "IPPrefixLen": 16,</span><br><span class="line">                    "IPv6Gateway": "",</span><br><span class="line">                    "GlobalIPv6Address": "",</span><br><span class="line">                    "GlobalIPv6PrefixLen": 0,</span><br><span class="line">                    "MacAddress": "02:42:ac:16:00:02",</span><br><span class="line">                    "DriverOpts": null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>由上面的输出可以看到，其IP地址为： <code>172.22.0.2</code>。</p>
<h2 id="访问测试"><a href="#访问测试" class="headerlink" title="访问测试"></a>访问测试</h2><h3 id="查看容器桥接网卡br0的ip"><a href="#查看容器桥接网卡br0的ip" class="headerlink" title="查看容器桥接网卡br0的ip"></a>查看容器桥接网卡<code>br0</code>的ip</h3><p>在容器的宿主机上，使用<code>ifconfig</code>命令可以查看<code>br0</code>的ip地址：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server5:~/<span class="built_in">test</span>$ ifconfig br0</span><br><span class="line">br0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.201.239  netmask 255.255.255.0  broadcast 192.168.201.255</span><br><span class="line">        inet6 fe80::4c68:f2ff:feac:809  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 4e:68:f2:ac:08:09  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 10655665  bytes 2097194705 (2.0 GB)</span><br><span class="line">        RX errors 0  dropped 4  overruns 0  frame 0</span><br><span class="line">        TX packets 10536545  bytes 2158837188 (2.1 GB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>
<p>可以看到，<code>ip</code>为<code>192.168.201.239</code>。当然，此处的ip也可以设为静态ip。</p>
<h3 id="设置客户机路由"><a href="#设置客户机路由" class="headerlink" title="设置客户机路由"></a>设置客户机路由</h3><p>在客户机上设置容器地址的访问路由：  </p>
<blockquote>
<p>看得到，容器分配的ip地址为172.16.0.0~172.31.255.255区间内的B内保留地址。</p>
</blockquote>
<figure class="highlight bash"><figcaption><span>此为Mac OS下的命令</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo route -n add -net 172.16.0.0 -netmask 255.240.0.0 192.168.201.239</span><br></pre></td></tr></table></figure>
<h3 id="浏览器查看"><a href="#浏览器查看" class="headerlink" title="浏览器查看"></a>浏览器查看</h3><p>由于我们启动的是nginx容器，因此，我们在浏览器端直接可以访问地址：<br><code>http://172.22.0.2/</code></p>
<p>你如果可以看到nginx的默认首页，就说明，我们可以直接访问到容器的服务了。  </p>
<h1 id="补充（Ubuntu-16-04）"><a href="#补充（Ubuntu-16-04）" class="headerlink" title="补充（Ubuntu 16.04）"></a>补充（Ubuntu 16.04）</h1><h2 id="桥接网络设置"><a href="#桥接网络设置" class="headerlink" title="桥接网络设置"></a>桥接网络设置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y bridge-utils</span><br></pre></td></tr></table></figure>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>容器的ip可以直接访问了，那么，接下来我们会进行<code>Apollo</code>的配置以及<code>spring boot cloud</code>的配置。这两个都会使用<code>erueka</code>服务。  </p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.mid-autumn.com/2019/01/11/Apollo配置中心部署指南（kubernetes）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忽然一夜清香发，散作乾坤万里春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/11/Apollo配置中心部署指南（kubernetes）/" class="post-title-link" itemprop="url">Apollo配置中心部署指南（kubernetes）</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-01-11 18:38:37" itemprop="dateCreated datePublished" datetime="2019-01-11T18:38:37+08:00">2019-01-11</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-01-12 16:00:17" itemprop="dateModified" datetime="2019-01-12T16:00:17+08:00">2019-01-12</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>采用微服务，就必须启动应用配置中心，否则的话，很多个应用，部署时的配置就非常繁琐。  </p>
<p>即使不用微服务，多种运行环境的管理也是很麻烦。<code>DEV</code>、<code>TEST ALPHA</code>、<code>TEST BETA</code>、<code>PROD</code>，众多的项目，其实本身就是个麻烦。  </p>
<p>对于<code>spring boog cloud</code>框架下的微服务，<code>spring projects</code>本身有提供<code>spring cloud config</code>用于作配置中心。但是有以下原因：</p>
<ul>
<li>其配置管理是基于文件形式的，如git库这种；</li>
<li>没有图形化的管理界面；</li>
<li>对于多个项目+多个环境，组合下来，对于一个系统，配置文件就比较多了，管理上也就稍显麻烦</li>
</ul>
<p>因此，建立一套功能完善易用的配置中心，势在必行。  </p>
<p>当前配置中心有： </p>
<ul>
<li><a href="https://github.com/spring-cloud/spring-cloud-config" target="_blank" rel="noopener">spring-cloud/spring-cloud-config</a></li>
<li><a href="https://github.com/takeseem/diamond" target="_blank" rel="noopener">淘宝 diamond</a></li>
<li><a href="https://github.com/knightliao/disconf" target="_blank" rel="noopener">disconf</a></li>
<li><a href="https://github.com/ctripcorp/apollo/" target="_blank" rel="noopener">ctrip apollo</a>
</li>
</ul>
<p>关于这四种配置中心的功能比较，可参见网页 <a href="统一配置中心选型对比https://www.cnblogs.com/xiaoqi/p/configserver-compair.html"></a>一文。</p>
<p>对于我们自己而言，后台开发主要使用的是<code>spring boot</code>及<code>spring boot cloud</code>，而类似于数据库的配置是需要在程序启动的时候，就要配置好的，否则，程序连不上库会直接退出。<br>而在列表里，只有<code>spring-cloud/spring-cloud-config</code>和<code>ctrip apollo</code>可以满足上面的要求。<br>同时，前面也说了一些<code>spring-cloud/spring-cloud-config</code>的不足之处，所以，我们最终选定使用<code>ctrip apollo</code>作为我们的配置中心。  </p>
<p>下面，记录下本次<code>ctrip apollo</code>的安装及部署过程。  </p>
<h1 id="kubernets下安装步骤"><a href="#kubernets下安装步骤" class="headerlink" title="kubernets下安装步骤"></a>kubernets下安装步骤</h1><h2 id="装备名字空间"><a href="#装备名字空间" class="headerlink" title="装备名字空间"></a>装备名字空间</h2><p>因为我们要将apollo作为当前及以后的所有系统的配置中心，因此，我们将系统在kubernetes下的namespace定为<code>kestrel-cloud-center</code>。</p>
<figure class="highlight yaml"><figcaption><span>kestrel-cloud-center-namespace.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Namespace</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">kestrel-cloud-center</span></span><br></pre></td></tr></table></figure>
<h2 id="准备kubernetes的存储pv和pvc"><a href="#准备kubernetes的存储pv和pvc" class="headerlink" title="准备kubernetes的存储pv和pvc"></a>准备kubernetes的存储pv和pvc</h2><p>我们当前使用一台做了raid-0阵列的主机作为一些核心服务的存储。当前这台机开启了nfs服务作为存储服务。因此，我们在使用配置pv的时候，直接使用nfs来作pv。</p>
<h3 id="声明PersistentVolume"><a href="#声明PersistentVolume" class="headerlink" title="声明PersistentVolume"></a>声明PersistentVolume</h3><figure class="highlight yaml"><figcaption><span>kestrel-cloud-center-pv.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolume</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">nfs-kestrel-cloud-mysql-pv</span></span><br><span class="line"><span class="attr">  namespace:</span> <span class="string">kestrel-cloud-center</span></span><br><span class="line"><span class="attr">  labels:</span></span><br><span class="line"><span class="attr">    pv:</span> <span class="string">nfs-kestrel-cloud-mysql-pv</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  capacity:</span></span><br><span class="line"><span class="attr">    storage:</span> <span class="number">3</span><span class="string">Gi</span></span><br><span class="line"><span class="attr">  accessModes:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ReadWriteMany</span></span><br><span class="line"><span class="attr">  nfs:</span></span><br><span class="line"><span class="attr">    server:</span> <span class="number">192.168</span><span class="number">.10</span><span class="number">.50</span></span><br><span class="line"><span class="attr">    path:</span> <span class="string">"/data1/nfs/pv/kestrel-cloud-center/mysql"</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="声明PersistentVolumeClaim"><a href="#声明PersistentVolumeClaim" class="headerlink" title="声明PersistentVolumeClaim"></a>声明PersistentVolumeClaim</h3><figure class="highlight yaml"><figcaption><span>kestrel-cloud-center-pvc.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">nfs-kestrel-cloud-mysql-pvc</span></span><br><span class="line"><span class="attr">  namespace:</span> <span class="string">kestrel-cloud-center</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  storageClassName:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">  resources:</span></span><br><span class="line"><span class="attr">    requests:</span></span><br><span class="line"><span class="attr">      storage:</span> <span class="number">3</span><span class="string">Gi</span></span><br><span class="line"><span class="attr">  accessModes:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ReadWriteMany</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    matchLabels:</span></span><br><span class="line"><span class="attr">      pv:</span> <span class="string">nfs-kestrel-cloud-mysql-pv</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.mid-autumn.com/2019/01/07/first/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王鹏">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忽然一夜清香发，散作乾坤万里春">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/01/07/first/" class="post-title-link" itemprop="url">开篇</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-01-07 19:49:48 / Modified: 19:52:26" itemprop="dateCreated datePublished" datetime="2019-01-07T19:49:48+08:00">2019-01-07</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2019，新的一年，新站开张，养成写作惯，慢慢编写并积累技术相关的文章！</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">王鹏</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                    <span class="site-state-item-count">0</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">王鹏</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.1.2</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.2"></script>

  <script src="/js/motion.js?v=7.1.2"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.2"></script>




  

  


  <script src="/js/next-boot.js?v=7.1.2"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
